<?xml version="1.0" encoding="UTF-8" ?>

<!-- 
This XML is responsible of installing custom tables to our databases
-->


<XMLDB PATH="mod/speval/db" VERSION="2025100300" COMMENT="SPEval tables">
    <TABLES>



	<TABLE NAME="speval" COMMENT="Stores SPEval activity instances">
        <FIELDS>
        	<FIELD NAME="id" TYPE="int" LENGTH="10" SEQUENCE="true" NOTNULL="true"/>
        	<FIELD NAME="course" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true"/>
            <FIELD NAME="linkedassignment" TYPE="int" LENGTH="10" NOTNULL="false" COMMENT="Foreign key to mdl_assign, null means standalone"/>
        	<FIELD NAME="name" TYPE="char" LENGTH="255" SEQUENCE="false" NOTNULL="true"/>
        	<FIELD NAME="intro" TYPE="text" SEQUENCE="false" NOTNULL="false"/>
        	<FIELD NAME="introformat" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
        	<FIELD NAME="criteria_count" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="3"/>
        	<FIELD NAME="timemodified" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true"/>
        </FIELDS>
    	    <KEYS>
 	       	<KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        	<KEY NAME="course" TYPE="foreign" FIELDS="course" REFTABLE="course" REFFIELDS="id"/>
            <KEY NAME="linkedassignment_fk" TYPE="foreign" FIELDS="linkedassignment" REFTABLE="assign" REFFIELDS="id"/>
   	    </KEYS>
	</TABLE>




    <TABLE NAME="speval_eval" COMMENT="Stores peer evaluations">
        <FIELDS>
            <FIELD NAME="id" TYPE="int" LENGTH="10" SEQUENCE="true" NOTNULL="true"/>
            <FIELD NAME="userid" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true" COMMENT="Who gave the evaluation"/>
            <FIELD NAME="peerid" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true" COMMENT="Who is being evaluated"/>
            <FIELD NAME="activityid" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true" DEFAULT="0" COMMENT="The SPEval activity instance ID"/>
            <FIELD NAME="criteria1" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="criteria2" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="criteria3" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="criteria4" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="criteria5" TYPE="int" LENGTH="4" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="comment1" TYPE="text" SEQUENCE="false" NOTNULL="false"/>
            <FIELD NAME="comment2" TYPE="text" SEQUENCE="false" NOTNULL="false"/>
            <FIELD NAME="timecreated" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true"/>
        </FIELDS>
        <KEYS>
            <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        </KEYS>
        <INDEXES>
            <INDEX NAME="id" UNIQUE="true" FIELDS="id"/>
        </INDEXES>
    </TABLE>



    <TABLE NAME="speval_grades" COMMENT="Stores calculated grades for peer evaluations">
        <FIELDS>
            <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
            <FIELD NAME="userid" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="activityid" TYPE="int" LENGTH="10" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="c1" TYPE="int" LENGTH="5" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="c2" TYPE="int" LENGTH="5" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="c3" TYPE="int" LENGTH="5" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="c4" TYPE="int" LENGTH="5" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="c5" TYPE="int" LENGTH="5" SEQUENCE="false" NOTNULL="true" DEFAULT="0"/>
            <FIELD NAME="finalgrade" TYPE="number" SEQUENCE="false" NOTNULL="true" DEFAULT="0.00"/>
        </FIELDS>
        <KEYS>
            <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        </KEYS>
    </TABLE>



    </TABLES>
</XMLDB>